"use strict";(self.webpackChunk_morgan_stanley_ComposeUI_gh_pages=self.webpackChunk_morgan_stanley_ComposeUI_gh_pages||[]).push([[86],{5923:function(n,e,a){a.r(e),a.d(e,{Head:function(){return m},default:function(){return h}});var s=a(8453),t=a(6540);function o(n){const e=Object.assign({p:"p",a:"a",h3:"h3",span:"span",h4:"h4",ul:"ul",li:"li"},(0,s.RP)(),n.components);return t.createElement(t.Fragment,null,"\n",t.createElement(e.p,null,"The Message Router is responsible for every communication that happens between processes. It is an independent pluggable module that runs under the main ComposeUI process, delivering messages between processes and optionally other devices.\nMessage Router is an open-source out-of-the-box library that is fast and reliable. It supports JSON and it also uses WebSockets and has a Javascript library, so Web-based applications can be integrated.\nSo basically it is real-time solution that can be easily setup for Pub-Sub messaging."),"\n",t.createElement(e.p,null,"More details can be found under the ",t.createElement(e.a,{href:"https://github.com/morganstanley/ComposeUI/blob/main/architecture/adr-012-message-router.md"},"ADR-012"),".\nThe Message Router is an ASP.NET Core-based backend service that exposes one or more endpoints that the applications can connect to."),"\n",t.createElement(e.h3,{id:"setup",style:{position:"relative"}},t.createElement(e.a,{href:"#setup","aria-label":"setup permalink",className:"anchor before"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Setup"),"\n",t.createElement(e.p,null,"Message Router Server can be setup in .NET by adding to the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">ServiceCollection</code>'}})," and its configuration like ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MessageRouterWebSocketServerOptions</code>'}})," after you have added the nuget package: ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MorganStanley.ComposeUI.Messaging.Server</code>'}}),"."),"\n",t.createElement(e.p,null,"Example:"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token class-name">IHostBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HostBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nbuilder<span class="token punctuation">.</span><span class="token function">ConfigureServices</span><span class="token punctuation">(</span>\n    services <span class="token operator">=></span>\n    <span class="token punctuation">{</span>\n        services<span class="token punctuation">.</span><span class="token function">AddMessageRouterServer</span><span class="token punctuation">(</span>\n            server <span class="token operator">=></span>\n            <span class="token punctuation">{</span>\n                server<span class="token punctuation">.</span><span class="token function">UseAccessTokenValidator</span><span class="token punctuation">(</span>\n                    <span class="token punctuation">(</span>clientId<span class="token punctuation">,</span> token<span class="token punctuation">)</span> <span class="token operator">=></span>\n                    <span class="token punctuation">{</span>\n                        <span class="token keyword">if</span> <span class="token punctuation">(</span>token <span class="token operator">!=</span> AccessToken<span class="token punctuation">)</span>\n                        <span class="token punctuation">{</span>\n                            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">InvalidOperationException</span><span class="token punctuation">(</span><span class="token string">"Invalid access token"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                        <span class="token punctuation">}</span>\n                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n                <span class="token function">ConfigureServer</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token function">ConfigureServices</span><span class="token punctuation">(</span>services<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n_host <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">await</span> _host<span class="token punctuation">.</span><span class="token function">StartAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"where with the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">ConfigureServer</code>'}})," method the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MessageRouterWebSocketServerOptions</code>'}})," - ",t.createElement(e.a,{href:"https://github.com/morganstanley/ComposeUI/blob/main/src/messaging/dotnet/src/Server/Server/WebSocket/MessageRouterWebSocketServerOptions.cs"},"reference"),", can be set with properties like ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">RootPath</code>'}})," and ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Port</code>'}}),".\nThe server implementation is only available on the .NET side."),"\n",t.createElement(e.p,null,"Also the Message Router Client can be set up in .NET easily with dependecy injection. You are able to call the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">AddMessageRouter()</code>'}})," extension method on a ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">IServiceCollection</code>'}})," where you can configure ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MessageRouterWebSocketOptions</code>'}})," - ",t.createElement(e.a,{href:"https://github.com/morganstanley/ComposeUI/blob/main/src/messaging/dotnet/src/Client/Client/WebSocket/MessageRouterWebSocketOptions.cs"},"reference"),", within the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">.UseWebSocket()</code>'}})," builder method and the AccessToken with the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">UseAccessToken</code>'}})," after you have added the nuget package: ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MorganStanley.ComposeUI.Messaging.Client</code>'}}),"."),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> services <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ServiceCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">AddMessageRouter</span><span class="token punctuation">(</span>\n        mr <span class="token operator">=></span> mr\n            <span class="token punctuation">.</span><span class="token function">UseWebSocket</span><span class="token punctuation">(</span>\n                <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MessageRouterWebSocketOptions</span>\n                <span class="token punctuation">{</span>\n                    Uri <span class="token operator">=</span> _webSocketUri\n                <span class="token punctuation">}</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">UseAccessToken</span><span class="token punctuation">(</span>AccessToken<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">BuildServiceProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"In Javascript/Typescript you should import the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">createMessageRouter</code>'}})," from the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">@morgan-stanley/composeui-messaging-client</code>'}})," library."),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createMessageRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'@morgan-stanley/composeui-messaging-client\'</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"Use ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">createMessageRouter()</code>'}})," to instantiate the MessageRouter client in a ComposeUI application. It will connect to the MessageRouter hosted by the container when you call ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">connect()</code>'}})," on the client."),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token function">createMessageRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"The ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MessageRouterConfig</code>'}})," will be read from a global variable - from the window’s ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">composeui.messageRouterConfig</code>'}}),", where the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">url</code>'}})," and the same property, ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">accessToken</code>'}})," can be set."),"\n",t.createElement(e.p,null,"If you are using the Message Router Client you will be able to get its unique client Id which shows the id of the current connection.\nYou can query that by calling the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">ClientId</code>'}})," property from the interface."),"\n",t.createElement(e.p,null,"In Javascript/Typescript side you can also get the same property from the interface by calling the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">clientId</code>'}})," property’s getter."),"\n",t.createElement(e.p,null,"The Message Router inteface provides a huge set of functionality to handle messages as it adds the ability for Pub-Sub messaging.\nTo directly connect to the server, you can call the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">ConnectAsync</code>'}})," method from the interface on the .NET side. Clients don’t need to call this method before calling any other methog on the interface. The client automatically establish the connection when needed.\nIn .NET you can connect to the server endpoint, by passing a ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">CancellationToken</code>'}})," as well which can control the connection lifetime. Not setting that will fallback on its default value which is ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">CancellationToken.None</code>'}}),"."),"\n",t.createElement(e.p,null,"In Javascript/Typescript you are also able to achieve this by calling the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">connect</code>'}})," method which returns a ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Promise&lt;void></code>'}}),"."),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.h3,{id:"usage",style:{position:"relative"}},t.createElement(e.a,{href:"#usage","aria-label":"usage permalink",className:"anchor before"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Usage"),"\n",t.createElement(e.h4,{id:"subscribe-to-a-topic",style:{position:"relative"}},t.createElement(e.a,{href:"#subscribe-to-a-topic","aria-label":"subscribe to a topic permalink",className:"anchor before"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Subscribe to a topic"),"\n",t.createElement(e.p,null,"Use the subscribe method of the client to set a handler on a topic. The message parameter of the handler method contains the payload as a string. The following example parses a JSON payload from the “exampleTopic” topic and logs it to console."),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,".NET"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token return-type class-name">ValuTask</span> <span class="token function">HandleTopicMessage</span><span class="token punctuation">(</span><span class="token class-name">MessageBuffer<span class="token punctuation">?</span></span> payload<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> ValueTask<span class="token punctuation">.</span>CompletedTask<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">await</span> _messageRouter<span class="token punctuation">.</span><span class="token function">SubscribeAsync</span><span class="token punctuation">(</span>\n    <span class="token string">"exampleTopic"</span><span class="token punctuation">,</span>\n    AsyncObserver<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Create</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TopicMessage<span class="token punctuation">></span></span></span><span class="token punctuation">(</span>x <span class="token operator">=></span> <span class="token function">HandleTopicMessage</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>Payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"It returns an ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">IAsyncDisposable</code>'}})," object."),"\n"),"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,"Javascript/TypeScript"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">client<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">\'exampleTopic\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> payload <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"It returns an ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Unsubscribable</code>'}})," object."),"\n"),"\n"),"\n",t.createElement(e.h4,{id:"publish-a-message",style:{position:"relative"}},t.createElement(e.a,{href:"#publish-a-message","aria-label":"publish a message permalink",className:"anchor before"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Publish a message"),"\n",t.createElement(e.p,null,"Use the publish method of the client to publish a message to a topic. The payload of the message must be a string. The following example creates a JSON string out of an object, and publishes it to the “exampleTopic” topic."),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,".NET"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">await</span> _messageRouter<span class="token punctuation">.</span><span class="token function">PublishAsync</span><span class="token punctuation">(</span>\n    \'exampleTopic\'<span class="token punctuation">,</span>\n    MessageBuffer<span class="token punctuation">.</span>Factory<span class="token punctuation">.</span><span class="token function">CreateJson</span><span class="token punctuation">(</span>payloadObject<span class="token punctuation">,</span> _jsonSerializerOptions<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"where ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">_jsonSerializerOptions</code>'}})," is your own defined serializer options to be used with the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">JsonSerializer</code>'}}),"."),"\n"),"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,"Javascript/Typescript"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">\'exampleTopic\'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>payloadObject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n"),"\n",t.createElement(e.h4,{id:"invoking-a-service",style:{position:"relative"}},t.createElement(e.a,{href:"#invoking-a-service","aria-label":"invoking a service permalink",className:"anchor before"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Invoking a service"),"\n",t.createElement(e.p,null,"Use the invoke method of the client to invoke a registered service’s handler and get the response from it. The payload must be a string."),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,".NET"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> resultBuffer <span class="token operator">=</span> <span class="token keyword">await</span> _messageRouter<span class="token punctuation">.</span><span class="token function">InvokeAsync</span><span class="token punctuation">(</span>\n    <span class="token string">"exampleTopic"</span><span class="token punctuation">,</span>\n    MessageBuffer<span class="token punctuation">.</span>Factory<span class="token punctuation">.</span><span class="token function">CreateJson</span><span class="token punctuation">(</span>payloadObject<span class="token punctuation">,</span> _jsonSerializerOptions<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"This results an ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MessageBuffer</code>'}})," -see ",t.createElement(e.a,{href:"https://github.com/morganstanley/ComposeUI/blob/main/src/messaging/dotnet/src/Core/MessageBuffer.cs"},"reference"),", type where you could call the ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">ReadJson&lt;T></code>'}})," extension method to convert the buffer to the expected type that the called service should return eg. ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">var result = resultBuffer.ReadJson&lt;MyClass>(_jsonSerializerOptions);</code>'}}),"."),"\n"),"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,"Javascript/Typescript"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> resultBuffer <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messageRouterClient<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">\'exampleTopic\'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>payloadObject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token operator">&lt;</span>MyClass<span class="token operator">></span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>resultBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n"),"\n",t.createElement(e.h4,{id:"registering-a-service",style:{position:"relative"}},t.createElement(e.a,{href:"#registering-a-service","aria-label":"registering a service permalink",className:"anchor before"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Registering a service"),"\n",t.createElement(e.p,null,"Use the register service method to register a service by providing its name and its handler. The handler should return the type of ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MessageBuffer?</code>'}})," so when a client calls the service they will receive the response from the registered handler function."),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,".NET"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">await</span> _messageRouter<span class="token punctuation">.</span><span class="token function">RegisterServiceAsync</span><span class="token punctuation">(</span>\n    <span class="token string">"exampleTopic"</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token operator">=></span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Payload is handled."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ValueTask<span class="token punctuation">&lt;</span>MessageBuffer<span class="token punctuation">?</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>MessageBuffer<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,"Javascript/Typescript"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">registerService</span><span class="token punctuation">(</span><span class="token string">\'exampleTopic\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">\'This is a test service\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n"),"\n",t.createElement(e.h4,{id:"unregistering-a-service",style:{position:"relative"}},t.createElement(e.a,{href:"#unregistering-a-service","aria-label":"unregistering a service permalink",className:"anchor before"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Unregistering a service"),"\n",t.createElement(e.p,null,"Use the unregister service method if you want to remove the service registration."),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,".NET"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">await</span> _messageRouter<span class="token punctuation">.</span><span class="token function">UnregisterServiceAsync</span><span class="token punctuation">(</span><span class="token string">"exampleTopic"</span><span class="token punctuation">,</span> cancellationToken<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,"Javascript/Typescript"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">unregisterService</span><span class="token punctuation">(</span><span class="token string">\'exampleTopic\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n"),"\n",t.createElement(e.h4,{id:"registering-an-endpoint",style:{position:"relative"}},t.createElement(e.a,{href:"#registering-an-endpoint","aria-label":"registering an endpoint permalink",className:"anchor before"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Registering an endpoint"),"\n",t.createElement(e.p,null,"Use register an endpoint method if you want to register an endpoint by providing a name, handler and optional descriptor - and of course optionally the cancellationToken. The main difference between the RegisterService and RegisterEndpoint is that when we register a service, then we send a register service call to the server so it gets registered on the server side while the endpoint is only registering the endpoint on the client so that endpoint could not be used for another service registered by the client.\nThe invoke request in this case would be solved “locally”."),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,".NET"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">await</span> _messageRouter<span class="token punctuation">.</span><span class="token function">RegisterEndpointAsync</span><span class="token punctuation">(</span>\n    <span class="token string">"exampleTopic"</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token operator">=></span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Payload is handled."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ValueTask<span class="token punctuation">&lt;</span>MessageBuffer<span class="token punctuation">?</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>MessageBuffer<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,"Javascript/Typescript"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">registerEndpoint</span><span class="token punctuation">(</span>\n  <span class="token string">\'exampleTopic\'</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token parameter">endpoint<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Payload is handled.\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n"),"\n",t.createElement(e.h4,{id:"unregistering-an-endpoint",style:{position:"relative"}},t.createElement(e.a,{href:"#unregistering-an-endpoint","aria-label":"unregistering an endpoint permalink",className:"anchor before"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Unregistering an endpoint"),"\n",t.createElement(e.p,null,"Use the unregister endpoint method if you want to remove an endpoint."),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,"NET"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> cancellationTokenSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CancellationTokenSource</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromMinutes</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">await</span> _messageRouter<span class="token punctuation">.</span><span class="token function">UnregisterEndpointAsync</span><span class="token punctuation">(</span><span class="token string">"exampleTopic"</span><span class="token punctuation">,</span> cancellationTokenSource<span class="token punctuation">.</span>Token<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n",t.createElement(e.li,null,"\n",t.createElement(e.p,null,"Javascript/Typescript"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">unregisterEndpoint</span><span class="token punctuation">(</span><span class="token string">\'exampleTopic\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n"),"\n"),"\n",t.createElement(e.p,null,"There are some optional values the above mentioned methods/functions eg.: ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">CancellationToken</code>'}})," or ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">EndpointDescriptior</code>'}}),", with you can add additional details to the Message Router or control the call, but you’ll find every detail when you are using the API as MessageRouter is well documented.\nIf you are interested explicitely on the API, you can find the source code on GitHub (",t.createElement(e.a,{href:"https://github.com/morganstanley/ComposeUI/blob/main/src/messaging/js/composeui-messaging-client/src/MessageRouter.ts"},"Typescript")," and ",t.createElement(e.a,{href:"https://github.com/morganstanley/ComposeUI/blob/main/src/messaging/dotnet/src/Core/IMessageRouter.cs"},".NET"),")."),"\n",t.createElement(e.p,null,"Example code snippets can be found under the ",t.createElement(e.a,{href:"https://github.com/morganstanley/ComposeUI/tree/main/examples/js-chart-and-grid-messagerouter"},"examples folder"),"."))}var c=function(n){void 0===n&&(n={});const{wrapper:e}=Object.assign({},(0,s.RP)(),n.components);return e?t.createElement(e,n,t.createElement(o,n)):o(n)},p=a(4794),l=a(4835),r=a(5927),i=a(2870),u=a(9878),g=a(3052),d=a(2891);const k=n=>{var e,a;let{children:s,data:o,pageContext:c,location:i}=n;const k=o.allMdx.nodes,h=o.mdx.tableOfContents.items,m=c.frontmatter.title,v=o.mdx.fields.slug,y=null===(e=o.site)||void 0===e||null===(a=e.siteMetadata)||void 0===a?void 0:a.title,f=(0,t.useMemo)(()=>o.allDirectory.nodes.reverse().map(n=>n.base),[o.allDirectory.nodes]),{0:E,1:b}=(0,t.useState)((0,d.M)(v,f)),S=(0,d.K)(k,(0,d.M)(v,f)),_=(0,t.useCallback)(n=>{const e=v.replace(E,n.target.value);b(n.target.value),(0,p.navigate)(e)},[E,v]);return t.createElement(r.A,{data:o,location:i,menu:c.menu},t.createElement("article",{className:"page-main content"},t.createElement("h3",null,y)),t.createElement("article",{className:"page-main content documentation-main"},t.createElement("nav",{className:"nav documentation-nav"},t.createElement("h4",null,"Documentation"),t.createElement(l.A,{sx:{mt:3}},t.createElement(g.A,{versions:f,selectedVersion:E,onChange:_})),t.createElement(u.w,{nodes:S,toc:h,location:i})),t.createElement("div",{className:"documentation-content"},t.createElement("header",null,t.createElement("h2",null,m)),s)))};function h(n){return t.createElement(k,n,t.createElement(c,n))}const m=n=>{let{data:e,pageContext:a}=n;const s=a.frontmatter.title+" | "+e.site.siteMetadata.title;return t.createElement(i.A,{title:s},t.createElement("meta",{name:"description",content:a.description}))}},9878:function(n,e,a){a.d(e,{w:function(){return o}});var s=a(6540),t=a(4794);const o=n=>{let{nodes:e,toc:a,location:o}=n;return s.createElement("ul",null,e.map((n,e)=>{const c=o.pathname.includes(n.fields.slug),p=n.frontmatter.title;return s.createElement("li",{key:e,className:c?"current":""},s.createElement(t.Link,{to:n.fields.slug},p),c&&s.createElement("nav",{className:"nav documentation-content-nav"},s.createElement("ul",null,a&&a.map((n,e)=>s.createElement("li",{key:"link-"+e},s.createElement(t.Link,{to:n.url},n.title))))))}))}}}]);
//# sourceMappingURL=component---node-modules-morganstanley-gatsby-theme-ms-gh-pages-src-templates-documentation-js-content-file-path-content-documentation-v-0-1-0-alpha-4-message-router-mdx-7e901059fc36d7d1b889.js.map